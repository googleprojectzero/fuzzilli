{
  "body": "Hits and snippets for Promise-related reductions and builtins (stable IDs):\n\n1) js-call-reducer: ReducePromisePrototypeThen\n- ID: js-call-reducer_promise_then\n- File: compiler/js-call-reducer.cc\n- Snippet: (lines ~7469-7533)\n  // Create the resulting JSPromise.\n  Node* promise = effect =\n      graph()->NewNode(javascript()->CreatePromise(), context, effect);\n  // Chain {result} onto {receiver}.\n  promise = effect = graph()->NewNode(\n      javascript()->PerformPromiseThen(), receiver, on_fulfilled, on_rejected,\n      promise, context, frame_state, effect, control);\n- Explanation: This reduction checks promise maps/protectors, creates a new JSPromise and lowers the then call to javascript()->PerformPromiseThen() simplified operator.\n\n2) js-call-reducer: ReducePromiseResolveTrampoline\n- ID: js-call-reducer_promise_resolve_trampoline\n- File: compiler/js-call-reducer.cc\n- Snippet: (lines ~7535-7569)\n  // Morph the {node} into a JSPromiseResolve operation.\n  node->ReplaceInput(0, receiver);\n  node->ReplaceInput(1, value);\n  node->ReplaceInput(2, context);\n  node->ReplaceInput(3, frame_state);\n  node->ReplaceInput(4, effect);\n  node->ReplaceInput(5, control);\n  NodeProperties::ChangeOp(node, javascript()->PromiseResolve());\n- Explanation: Lowers Promise.resolve trampoline to javascript()->PromiseResolve() simplified op when receiver maps are JSReceivers.\n\n3) Builtins / CSA definitions (Torque -> generated CSA)\n- ID: builtins_promise_perform_and_fulfill\n- Files: builtins/promise-abstract-operations.tq (defines PerformPromiseThen, FulfillPromise macros), builtins/promise-resolve.tq, builtins/promise-jobs.tq, generated: builtins/builtins-promise-gen.h/.cc and various builtins-*.cc generated sources\n- Snippet examples:\n  // builtins/promise-abstract-operations.tq: transitioning builtin PerformPromiseThen(...)\n  // builtins/promise-resolve.tq: transitioning builtin PromiseResolve(...)\n- Explanation: These Torque definitions produce CodeStubAssembler builtins (CSA) used at runtime and referenced by the JS reductions (PerformPromiseThen, FulfillPromise, PromiseResolveThenableJob, PromiseResolve).\n\n4) JSPromise C++ helpers: Resolve / Fulfill / Reject and PromiseReaction/Capability creation\n- ID: objects_jspromise_resolve_fulfill\n- File: objects/objects.cc (JSPromise::Resolve / JSPromise::Reject / JSPromise::Fulfill implementations)\n- Snippet: (JSPromise::Resolve)\n  // If Type(resolution) is not Object, then\n  if (!TryCast<JSReceiver>(resolution_obj, &resolution_recv)) {\n    // a. Return FulfillPromise(promise, resolution).\n    return Fulfill(promise, resolution_obj);\n  }\n  // later: NewPromiseResolveThenableJob: factory()->NewPromiseResolveThenableJobTask(...)\n- Explanation: Shows how JSPromise::Resolve implements spec steps, creates PromiseResolveThenableJobTask, and enqueues to the microtask queue.\n\n5) Microtask queue: enqueue/drain\n- ID: microtask_queue_impl\n- Files: execution/microtask-queue.h, execution/microtask-queue.cc, builtins/builtins-microtask-queue-gen.cc\n- Snippet: (execution/microtask-queue.cc)\n  void MicrotaskQueue::EnqueueMicrotask(Tagged<Microtask> microtask) { ... }\n  void MicrotaskQueue::PerformCheckpointInternal(v8::Isolate* v8_isolate) { ... }\n- Explanation: These implement EnqueueMicrotask and PerformCheckpoint/RunMicrotasks used to schedule and run promise jobs (PromiseReactionJobTask, PromiseResolveThenableJobTask).\n\nFileLine references: compiler/js-call-reducer.cc:7469-7569, builtins/promise-abstract-operations.tq, builtins/promise-resolve.tq, builtins/promise-jobs.tq, builtins/builtins-promise-gen.cc/h, objects/objects.cc:~5050-5160 (JSPromise::Resolve/Fulfill/Reject), execution/microtask-queue.cc/h\n\nWhy saved: central cross-reference for TurboFan reductions -> CSA builtins -> C++ runtime and microtask scheduling. Use these IDs to map IR nodes (JSPerformPromiseThen, JSFulfillPromise, JSPromiseResolve) to CSA builtin implementations and runtime behaviors.",
  "context": [
    "js-call-reducer_promise_then",
    "js-call-reducer_promise_resolve_trampoline",
    "builtins_promise_perform_and_fulfill",
    "objects_jspromise_resolve_fulfill",
    "microtask_queue_impl"
  ],
  "explanation": "Aggregated, validated set of locations and short snippets for Promise reductions (ReducePromisePrototypeThen/ResolveTrampoline), CSA builtins (PerformPromiseThen/FulfillPromise/PromiseResolve/PromiseResolveThenableJob), JSPromise resolve/reject/fulfill internals, and microtask queue enqueue/drain logic. Useful stable IDs to cross-reference TurboFan IR nodes to CSA/runtime implementations.",
  "file_line": "compiler/js-call-reducer.cc:7469-7569; objects/objects.cc:5050-5170; execution/microtask-queue.cc; builtins/*.tq; builtins/builtins-promise-gen.cc/h"
}