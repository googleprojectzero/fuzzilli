{
  "body": "File: src/runtime/runtime-wasm.cc\n- Wrapper tiering/upgrade entry points and budgets:\n  - Runtime_TierUpJSToWasmWrapper(WasmExportedFunctionData):\n    \u2022 Looks up or compiles per-signature JS\u2192Wasm wrapper via isolate heap weak cache (js_to_wasm_wrappers). Replaces wrapper code for the triggering export and all exports with same signature. Uses helper ReplaceJSToWasmWrapper() to update JSFunction code and WasmExportedFunctionData::wrapper_code.\n  - Runtime_TierUpWasmToJSWrapper(WasmImportData):\n    \u2022 Determines ImportCallKind (handles WasmInternalFunction path differently from dispatch-table path). Consults WasmImportWrapperCache for compiled wrapper by (kind,sig_index,expected_arity,suspend), compiles if missing, then installs compiled wrapper via WasmDispatchTable::InstallCompiledWrapper. For WasmJSFunctionData, installs compiled wrapper through OffheapData::set_compiled_wrapper(), reusing same CodePointerTable entry.\n  - Runtime_WasmTriggerTierUp(WasmTrustedInstanceData): triggers function body tier-up (Liftoff\u2192Turbofan) and manages per-function budget array: trusted_instance_data->tiering_budget_array()[declared_index] store(v8_flags.wasm_tiering_budget). Uses WasmFrame finder to identify function index.\n- Feature/flags influencing wrappers:\n  - thread_in_wasm / ClearThreadInWasmScope: ensures correct flag state across runtime calls and JS interop.\n  - Promise-based suspension: Several runtimes support suspender creation and stack switching: Runtime_WasmAllocateSuspender and paths used by wrappers; Wasm to JS wrapper calls Builtin::kWasmSuspend, promise.then hooking.\n  - BigInt/i64: runtimes provide To/From BigInt helpers and string functions not directly in wrappers but used by builtins the wrappers call; however wrappers call conversion builtins directly.\n",
  "context": [
    "js_to_wasm_cache_tiering",
    "wasm_import_wrapper_cache",
    "wrappers_turboshaft_entry"
  ],
  "explanation": "Captures runtime tiering upgrade entry points for both wrapper directions and the function-body tier-up trigger, plus the role of budgets and feature hooks relevant for wrappers at runtime.",
  "file_line": "runtime/runtime-wasm.cc:~2164-2388,~2263-2354,~2356-2410"
}