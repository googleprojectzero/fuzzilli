{
  "body": "File: src/wasm/function-compiler.cc\n- Class: v8::internal::wasm::JSToWasmWrapperCompilationUnit\n  - Purpose: Compiles TurboShaft-based JS\u2192Wasm export wrappers and installs into per-isolate cache; handles tier-up.\n  - Constructor: Creates a TurboshaftCompilationJob via compiler::NewJSToWasmCompilationJob(isolate, sig) unless wasm_jitless.\n  - Execute(): Runs job->ExecuteJob.\n  - Finalize(): Finalizes job to produce Handle<Code>; logs code creation if enabled; ASSERTS cache slot is empty then installs wrapper in isolate-local weak array cache: isolate->heap()->js_to_wasm_wrappers()->set(sig_index.index, MakeWeak(code->wrapper())). Increments counters.\n  - static CompileJSToWasmWrapper(Isolate*, const CanonicalSig*, CanonicalTypeIndex): synchronous helper to compile and cache wrapper, used at tier-up.\n- Tier-up runtime:\n  File: src/runtime/runtime-wasm.cc\n  - Runtime_TierUpJSToWasmWrapper(WasmExportedFunctionData function_data):\n    \u2022 Determines signature id, looks up isolate->heap()->js_to_wasm_wrappers()[sig_id.index] weak cache. If present, uses Code; else compiles via JSToWasmWrapperCompilationUnit::CompileJSToWasmWrapper and asserts cache population.\n    \u2022 Replaces wrapper code on current exporting JSFunctions via ReplaceJSToWasmWrapper() and iterates export table to eagerly update all exports sharing the signature.\n  - ReplaceJSToWasmWrapper: Locates JSFunction external for func_ref and updates code and WasmExportedFunctionData::wrapper_code.\n- Notes:\n  - Per-isolate JS\u2192Wasm wrapper cache: a WeakFixedArray heap root heap()->js_to_wasm_wrappers(); entries are weak references to CodeWrapper of wrapper Code objects, keyed by CanonicalTypeIndex.index of function signature.\n  - Build path: These wrappers are built by Turboshaft wrapper pipeline in src/wasm/wrappers.cc under CodeKind::JS_TO_WASM_FUNCTION, invoked via compiler driver NewJSToWasmCompilationJob.\n",
  "context": [
    "wrappers_turboshaft_entry",
    "runtime_tiering_points",
    "wasm_objects_classes"
  ],
  "explanation": "Captures per-isolate JS\u2192Wasm export wrapper cache and the tier-up mechanism that replaces generic wrappers with optimized ones, anchoring both build and runtime upgrade code.",
  "file_line": "wasm/function-compiler.cc:~65-; runtime/runtime-wasm.cc:~2164-2261"
}