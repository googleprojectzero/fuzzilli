{
  "body": "File: src/runtime/runtime-wasm.cc\nSymbols and roles:\n- Runtime_TierUpJSToWasmWrapper(function_data): Tier-ups JS\u2192Wasm wrappers.\n  - Computes signature id (CanonicalTypeIndex) from function\u2019s sig, looks up per-isolate js_to_wasm_wrappers weak array. If cached wrapper exists, reuse; else compiles via JSToWasmWrapperCompilationUnit::CompileJSToWasmWrapper(isolate, sig, sig_id). Then replaces wrapper for the triggering export (ReplaceJSToWasmWrapper) and all other exports with same signature by updating external JSFunction\u2019s code and WasmExportedFunctionData::wrapper_code.\n- Runtime_TierUpWasmToJSWrapper(import_data): Tier-ups Wasm\u2192JS import wrapper for a specific import.\n  - Resolves ImportCallKind and expected_arity (JSFunction arity match/mismatch or Call builtin), obtains WasmImportWrapperCache, and gets or compiles wrapper (cache->MaybeGet/CompileWasmImportCallWrapper). If origin is WasmInternalFunction, updates its CPT entries: For WasmJSFunctionData, offheap_data()->set_compiled_wrapper(wrapper); otherwise uses instance\u2019s dispatch table to InstallCompiledWrapper for the function index. If origin is a WasmDispatchTable, uses its sig(table_slot) and installs compiled wrapper into dispatch table.\n- Runtime_WasmTriggerTierUp(trusted_instance_data): triggers function tier-up budget mechanism; not wrapper-specific, but used in tiering and interrupt path.\n- Numerous runtime helpers used by wrappers: Runtime_WasmJSToWasmObject, Runtime_WasmGenericWasmToJSObject, Runtime_WasmInternalFunctionCreateExternal, various string helpers, and stack switching/suspender allocation routines.\nContext with wrappers:\n- ThreadInWasm flag clear/set: ClearThreadInWasmScope used in many runtime entries for proper asm.js attribution and timing; wrappers themselves toggle flag around JS callbacks.\n- Tiering budgets: When a heavy function triggers tier-up, runtime ensures budget reset and triggers compilation of higher-tier code; wrappers tie into this by replacing wrapper code on-demand per signature/import.\n",
  "context": [
    "wrappers_ts",
    "tf_hooks",
    "js_to_wasm_cu",
    "import_cache",
    "wasm_objects"
  ],
  "explanation": "This captures the runtime entry points that perform tier-up of both JS\u2192Wasm and Wasm\u2192JS wrappers, and shows how these connect to the per-isolate wrapper cache, the process-wide import wrapper cache, and object model updates. It provides the execution-time hooks wiring the wrapper compilation and installation.",
  "file_line": "runtime/runtime-wasm.cc: ~ lines 1150-1490 (tier-up fns) and surrounding"
}