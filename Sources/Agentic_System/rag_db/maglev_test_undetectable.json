{
  "body": "Maglev TestUndetectable lowering and codegen\n\nFiles and symbols:\n- maglev/maglev-ir.h: class TestUndetectable : public FixedInputValueNodeT<1, TestUndetectable>\n- maglev/maglev-graph-builder.cc: MaglevGraphBuilder::BuildTestUndetectable and MaglevGraphBuilder::VisitTestUndetectable are where nodes are created. BuildToBoolean uses BuildTestUndetectable for JSReceiver case, and BuildTestUndetectable returns AddNewNode<TestUndetectable>.\n- maglev/maglev-ir.cc: TestUndetectable::GenerateCode(MaglevAssembler* masm, ...) implements codegen\n- maglev/maglev-assembler.cc/h: MaglevAssembler::JumpIfUndetectable / JumpIfNotUndetectable and ToBoolean helper use DependOnNoUndetectableObjectsProtector when checking roots vs map bit\n\nKey excerpts:\n- MaglevGraphBuilder::BuildToBoolean calls BuildTestUndetectable(value) when CheckType(value, NodeType::kJSReceiver) and uses the result in ToBoolean paths. BuildTestUndetectable creates a TestUndetectable node.\n- maglev-assembler.cc implements JumpIfUndetectable/Register-level checks: it checks Smi/heapobject, loads map, tests Map::Bits1::IsUndetectableBit, and in ToBoolean uses broker()->dependencies()->DependOnNoUndetectableObjectsProtector() to decide whether to check null/undefined roots early (see ToBoolean earlier in file).\n- maglev-ir.cc's TestUndetectable::GenerateCode will emit JumpIfUndetectable/JumpIfNotUndetectable which in turn will call compilation_info()->broker()->dependencies()->DependOnNoUndetectableObjectsProtector() at build time to attach protector dependence. Deopt/assumptions: Maglev attaches dependencies via broker()->dependencies()->DependOnNoUndetectableObjectsProtector() in assembler paths (ToBoolean and JumpIfX) indicating protector-based assumptions and potential deopt when protector invalidated.\n\nFiles/lines: maglev/maglev-graph-builder.cc (BuildTestUndetectable/VisitTestUndetectable), maglev/maglev-ir.cc (TestUndetectable::GenerateCode), maglev/maglev-assembler.cc (JumpIfUndetectable/JumpIfNotUndetectable, ToBoolean)\n\nExplanation: Maglev lowers JSReceiver ToBoolean via TestUndetectable node which generates conditional jumps using MaglevAssembler helpers that consult CompilationDependencies::DependOnNoUndetectableObjectsProtector to attach protector dependencies for optimized paths (checking null/undefined roots instead of map undetectable bit).",
  "context": [
    "maglev",
    "test_undetectable",
    "protector_dependency"
  ],
  "explanation": "Records where Maglev builds TestUndetectable nodes, their codegen and how the MaglevAssembler uses the protector dependence to emit faster root checks and attach dependencies.",
  "file_line": "maglev/maglev-graph-builder.cc / maglev/maglev-ir.cc / maglev/maglev-assembler.cc"
}