{
  "body": "File: src/compiler/wasm-compiler.cc\nSymbols and roles:\n- WasmWrapperGraphBuilder (class inside compiler namespace): TF counterpart providing wrapper graph assembly for various wrapper kinds. Key methods:\n  - BuildJSToWasmWrapper(do_conversion=false/true, frame_state, set_in_wasm_flag): Inlines JS\u2192Wasm wrapper into TF graphs for JS functions. Mirrors TS logic: param building, optional fast-path conversion (FromJSFast, CanTransformFast), default FromJS, BuildCallAndReturn to call wasm through WasmInternalFunction (load call target and implicit arg), ToJS conversions, multi-return array allocation, optional begin/end execution trace calls under flags, and int64 lowering when necessary.\n  - BuildWasmToJSWrapper(ImportCallKind kind, int expected_arity, Suspend suspend): Builds Wasm\u2192JS import wrapper in TF, clearing thread-in-wasm flag, optional central stack switching, two call strategies (JSCallDescriptor for direct JSFunction vs Call_ReceiverIsAny stub for generic case), sets source positions (0/1) for asm.js, supports suspension by calling Builtin::kWasmSuspend and promise choreography; converts return values back to wasm using FromJS.\n  - BuildJSFastApiCallWrapper(Handle<JSReceiver>): Builds fast API call wrappers using fast_api_call lowering; falls back to CallTrampoline if needed; returns converted value through FromJS.\n  - BuildCWas mEntry(): Builds C-wasm entry stub packing args/returns into buffer; arranges frame pointer storing (c_entry_fp) and return of exception or 0.\n  - BuildSwitchToTheCentralStack()/Back()/IfNeeded(): TF variants of stack switching used in import wrappers and suspension.\n  - BuildModifyThreadInWasmFlagHelper/BuildModifyThreadInWasmFlag: Toggle thread_in_wasm flag in TF.\n  - Utility conversions: BuildChangeInt32ToNumber, BuildChangeTaggedToInt32/Float64, BuildChangeBigIntToInt64, ToJS, FromJS, fast-path helpers; LoadSharedFunctionInfo, BuildReceiverNode.\n- BuildInlinedJSToWasmWrapper(zone, mcgraph, signature, isolate, spt, frame_state, set_in_wasm_flag): Helper to inline a JS\u2192Wasm wrapper into TF-compiled JS function; calls WasmWrapperGraphBuilder::BuildJSToWasmWrapper with do_conversion=false.\n- NewJSToWasmCompilationJob(Isolate*, const CanonicalSig*): Returns a Turboshaft wrapper compilation job for JS_TO_WASM_FUNCTION via Pipeline::NewWasmTurboshaftWrapperCompilationJob. Used by function-compiler JSToWasmWrapperCompilationUnit.\n- CompileWasmImportCallWrapper(ImportCallKind, const CanonicalSig*, bool source_positions, int expected_arity, Suspend): Builds Wasm\u2192JS wrapper code via Pipeline::GenerateCodeForWasmNativeStubFromTurboshaft with WrapperCompilationInfo{CodeKind::WASM_TO_JS_FUNCTION, kind, expected_arity, suspend}. Emits name wasm-to-js-<kind>-<sig> and tracing.\n- CompileWasmCapiCallWrapper(sig): Generates WASM_TO_CAPI_FUNCTION code via GenerateCodeForWasmNativeStubFromTurboshaft.\n- CompileWasmJSFastCallWrapper(sig, callable): Generates fast-API wasm-to-JS wrapper code using TF builder and Pipeline::GenerateCodeForWasmNativeStub.\n- CompileCWasmEntry(sig) \u2192 Code: Builds C entry stub in TF then compiles via Pipeline::NewWasmHeapStubCompilationJob.\n- Support utilities: CreateCommonMachineGraph, WasmAssemblerOptions/WasmStubAssemblerOptions adjust builtin call mode and serialization flags.\n",
  "context": [
    "wrappers_ts",
    "js_to_wasm_cu",
    "import_cache",
    "call_desc",
    "runtime_tiering"
  ],
  "explanation": "This captures the TF-side wrapper hooks and codegen entry points. It establishes how wrappers are compiled in the pipeline, including the job factory for JS\u2192Wasm, the wrapper compiler for imports, and inlining glue. It directly connects to the per-isolate JSToWasmWrapperCompilationUnit and to the wrapper cache pipeline.",
  "file_line": "compiler/wasm-compiler.cc:6001-8625 (key wrapper parts); plus earlier class definitions."
}