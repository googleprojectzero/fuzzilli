{
  "body": "File: src/wasm/wasm-import-wrapper-cache.{h,cc}\nSymbols and roles:\n- class WasmImportWrapperCache: Process-wide cache for compiled Wasm\u2192JS import wrappers.\n  - struct CacheKey { ImportCallKind kind; CanonicalTypeIndex type_index; int expected_arity; Suspend suspend; } with equality and hash; used in unordered_map entry_map_.\n  - ModificationScope: RAII holding SpinningMutex; operator[](key) returns existing WasmCode*; AddWrapper(key, WasmCompilationResult, WasmCode::Kind) allocates code space via WasmCodeAllocator, writes code, relocates with apply(delta), constructs WasmCode object, inserts into entry_map_ and codes_ map (instruction_start\u2192WasmCode*), lowers initial refcount via AddRef/DecRefOnLiveCode, and returns pointer.\n  - LazyInitialize(Isolate*): Allocates code space region for the cache using WasmCodeManager; initializes WasmCodeAllocator and code range.\n  - MaybeGet(kind, type_index, expected_arity, suspend): Thread-safe lookup; adds ref to WasmCodeRefScope; returns nullptr if missing.\n  - CompileWasmImportCallWrapper(isolate, kind, sig, sig_index, source_positions, expected_arity, suspend): Calls compiler::CompileWasmImportCallWrapper to generate code, within ModificationScope installs into cache if absent, logs and updates counters; returns WasmCode*.\n  - Lookup(Address pc): Find wrapper by program counter for disassembly printing; returns with WasmCodeRefScope::AddRef.\n  - FindWrapper(WasmCodePointer call_target): Uses CPT to resolve entrypoint back to WasmCode*; used for tier-up update.\n  - Free(std::vector<WasmCode*>&): Removes given wrappers from entry_map_ and codes_, frees code through allocator, deletes WasmCode objects.\n  - LogForIsolate(Isolate*), EstimateCurrentMemoryConsumption(): diagnostics.\nData members:\n- std::unique_ptr<WasmCodeAllocator> code_allocator_;\n- mutable base::SpinningMutex mutex_;\n- std::unordered_map<CacheKey, WasmCode*, CacheKeyHash> entry_map_;\n- std::map<Address, WasmCode*> codes_;\n\nNotes:\n- Wrappers are anonymous WasmCode objects (no NativeModule) allocated in cache\u2019s code space; not serialized.\n- Built wrappers are installed for imports via dispatch tables and support tier-up (see runtime).\n",
  "context": [
    "tf_hooks",
    "runtime_tiering",
    "wrappers_ts"
  ],
  "explanation": "Captures the process-wide cache managing Wasm\u2192JS import wrappers, including key structure, compilation path, and memory management lifecycle. Central to WasmToJS wrapper reuse, tier-up, and lookup.",
  "file_line": "wasm/wasm-import-wrapper-cache.h:1-; wasm/wasm-import-wrapper-cache.cc:1-"
}