{
  "body": "Summary of discovered locations for KeyedLoadIC string-index fast path and related protector/handlers.\n\nIC and handler selection (KeyedLoadIC):\n- src/ic/ic.cc: KeyedLoadIC::Load(Handle<JSAny> object, Handle<Object> key) - converts key (TryConvertKey), calls RuntimeLoad and, on int-like keys, calls UpdateLoadElement to attach handler. (symbols: KeyedLoadIC::Load, KeyedLoadIC::UpdateLoadElement, KeyedLoadIC::LoadElementHandler, KeyedLoadIC::LoadElementPolymorphicHandlers)\n- src/ic/handler-configuration.h / src/ic/handler-configuration-inl.h: LoadHandler::LoadIndexedString(Isolate*, KeyedAccessLoadMode) encodes an indexed-string Smi handler. (symbols: LoadHandler::LoadIndexedString, LoadHandler::GetHandlerKind)\n- src/ic/handler-configuration-inl.h: implementation of LoadIndexedString returns Kind::kIndexedString Smi.\n- src/ic/handler-configuration.cc: handling and printing for Kind::kIndexedString.\n\nBuiltins / stub generation:\n- src/builtins/builtins-ic-gen.cc: Builtins::Generate_KeyedLoadIC (invokes assembler.GenerateKeyedLoadIC) and Generate_KeyedLoadIC_Megamorphic / Trampoline variants. (symbols: Builtins::Generate_KeyedLoadIC, Builtins::Generate_KeyedLoadIC_Megamorphic, etc.)\n- src/ic/accessor-assembler.cc: AccessorAssembler::GenerateKeyedLoadIC and GenerateKeyedLoadIC_Megamorphic generate CSA codepaths for keyed loads and include branches for handler kinds including LOAD_KIND(kIndexedString).\n- src/builtins/builtins-handler-gen.cc: TF_BUILTIN(KeyedLoadIC_SloppyArguments, HandlerBuiltinsAssembler) provides other keyed-load builtins referenced by handlers.\n\nCSA (CodeStubAssembler) helpers and protector attachment/invalidation:\n- src/codegen/code-stub-assembler.h / .cc: CodeStubAssembler::IsStringWrapperElementsKind(TNode<Map> map), CodeStubAssembler::IsStringWrapper(TNode<HeapObject> object), CodeStubAssembler::InvalidateStringWrapperToPrimitiveProtector(). (symbols: CodeStubAssembler::InvalidateStringWrapperToPrimitiveProtector, CodeStubAssembler::IsStringWrapper)\n- src/codegen/heap-object-list.h and src/roots/roots.h: Root/heap list contains StringWrapperToPrimitiveProtector / string_wrapper_to_primitive_protector root.\n- src/execution/protectors.h and src/execution/protectors-inl.h: Protectors enum and helpers; symbol: Protectors::IsStringWrapperToPrimitiveIntact(Isolate*) and Protectors::InvalidateStringWrapperToPrimitive(Isolate*) (declared in protectors.h and defined/inlined elsewhere).\n- src/execution/isolate.cc: Isolate::UpdateStringWrapperToPrimitiveProtectorOnSetPrototype and calls to Protectors::InvalidateStringWrapperToPrimitive on relevant prototype changes.\n- src/objects/lookup.cc: checks Protectors::IsStringWrapperToPrimitiveIntact(isolate) before taking fast-paths for string wrapper treatment; calls Protectors::InvalidateStringWrapperToPrimitive(isolate) on certain lookup mutations.\n- src/builtins/builtins-string.tq and src/builtins/base.tq: macro InvalidateStringWrapperToPrimitiveProtector() used in builtins that mutate String.prototype (e.g., define properties) to emit protector invalidation.\n\nProtector cell location and name:\n- Root index / heap root: string_wrapper_to_primitive_protector is the root name (see src/codegen/heap-object-list.h and src/roots/roots.h). Runtime export: runtime/runtime.h contains F(StringWrapperToPrimitiveProtector,...)\n- Access via Protectors::IsStringWrapperToPrimitiveIntact/isolate methods; there are runtime helpers (Runtime_StringWrapperToPrimitiveProtector in runtime/runtime-test.cc as a test runtime entry).\n\nWhere CSA-generated keyed-load handlers short-circuit to character loads:\n- The CSA KeyedLoadIC builtin path (ic/accessor-assembler.cc) branches on handler kind equal to kIndexedString and goes to the specialized handler code that directly loads characters from strings (via CodeStubAssembler primitives like LoadStringCharacterAsCode and bounds checks). The exact code lives in AccessorAssembler::KeyedLoadIC / KeyedLoadICGeneric in ic/accessor-assembler.cc which dispatch to the builtin handlers generated in builtins-ic-gen.cc.\n- compiler/js-native-context-specialization.cc: JSNativeContextSpecialization::BuildIndexedStringLoad builds a lowered sequence for indexed string loads when the receiver is a string (or string wrapper after unwrapping), emitting nodes that compute length, bounds, and read from SeqOneByte/TwoByte or external strings and produce tagged result; this is consumed by TurboFan.\n- maglev/maglev-graph-builder.cc & maglev/*: Maglev nodes like CheckStringOrStringWrapper, StringWrapperConcat etc. and use DependOnStringWrapperToPrimitiveProtector() to attach protector dependency to generated graph.\n- turbofan lowering passes reference CheckStringOrStringWrapper, CompilationDependencies::DependOnStringWrapperToPrimitiveProtector() and relevant reducers: compiler/typed-optimization.cc (ReduceCheckStringOrStringWrapper), compiler/js-generic-lowering.cc etc.\n\nInvalidation callsites / paths:\n- Mutations that can change whether string wrappers are observed as primitive: defining properties on String.prototype (DefineProperty), adding element accessors, setting prototype (SetPrototypeOf), Proxy traps (getOwnPropertyDescriptor / defineProperty traps), and operations that change prototype chain that lookup.cc and isolate.cc watch. Specific call sites:\n  - src/execution/isolate.cc: UpdateStringWrapperToPrimitiveProtectorOnSetPrototype called from SetPrototypeOf flows.\n  - src/builtins/builtins-string.tq and base.tq: InvalidateStringWrapperToPrimitiveProtector() invoked when builtins define or modify methods on String.prototype.\n  - src/objects/lookup.cc and src/objects/lookup.cc lines checking protector and invalidating under certain property defines.\n\nInterpreter / feedback emission:\n- src/interpreter/interpreter-generator.cc and src/interpreter/bytecode-generator.cc: interpreter emits calls to Builtin::kKeyedLoadIC and adds FeedbackSlot via feedback_spec()->AddKeyedLoadICSlot(); bytecode generator uses that slot for keyed loads. Symbols: CallBuiltin(Builtin::kKeyedLoadIC,...), and use of feedback slots in bytecode.\n- Feedback evolution logic in src/ic/ic.cc: IC::ConfigureVectorState, IC::SetCache, KeyedLoadIC::UpdateLoadElement, and KeyedLoadIC::Load update nexus()/FeedbackVector to progress UNINITIALIZED -> MONOMORPHIC -> POLYMORPHIC (ConfigureMonomorphic/ConfigurePolymorphic) and eventually MEGAMORPHIC. TryConvertKey in KeyedLoadIC handles Smi/HeapNumber/String->int key classification used to determine when to attach indexed-string handlers.\n\nConsumption in Sparkplug/Maglev/TurboFan:\n- Maglev: maglev-graph-builder.cc and maglev-ir.cc contain nodes and builder logic to DependOnStringWrapperToPrimitiveProtector() when lowering JS string operations; maglev nodes CheckStringOrStringWrapper materialize guards and deopt reasons (See maglev/*: CheckStringOrStringWrapper, StringWrapperConcat).\n- Sparkplug/baseline: baseline/baseline-compiler.cc calls Builtin::kKeyedLoadICBaseline for baseline IC trampoline.\n- TurboFan: compiler/js-native-context-specialization.cc BuildIndexedStringLoad and compiler/js-generic-lowering.cc lower JSIndexed loads into nodes that may use StringCharCodeAt or direct LoadElement from string backing store; CompilationDependencies::DependOnStringWrapperToPrimitiveProtector() ensures protector dependency attached in optimized code.\n\nRepresentative file references and symbols (precise):\n- src/ic/ic.cc: KeyedLoadIC::Load, KeyedLoadIC::UpdateLoadElement, KeyedLoadIC::LoadElementHandler (lines around 1300-1420)\n- src/ic/handler-configuration-inl.h: LoadHandler::LoadIndexedString (definition)\n- src/ic/handler-configuration.h: class LoadHandler declaration with Kind::kIndexedString\n- src/ic/accessor-assembler.cc: AccessorAssembler::GenerateKeyedLoadIC / KeyedLoadICGeneric (CSA fast-paths for LOAD_KIND(kIndexedString))\n- src/builtins/builtins-ic-gen.cc: Builtins::Generate_KeyedLoadIC\n- src/codegen/code-stub-assembler.h/.cc: CodeStubAssembler::IsStringWrapper, ::IsStringWrapperElementsKind, ::InvalidateStringWrapperToPrimitiveProtector\n- src/execution/protectors.h/.cc and src/execution/isolate.cc: Protectors::IsStringWrapperToPrimitiveIntact, Protectors::InvalidateStringWrapperToPrimitive, Isolate::UpdateStringWrapperToPrimitiveProtectorOnSetPrototype\n- src/roots/roots.h and src/codegen/heap-object-list.h: root name string_wrapper_to_primitive_protector\n- src/interpreter/interpreter-generator.cc and src/interpreter/bytecode-generator.cc: emission of KeyedLoadIC call and feedback slot (AddKeyedLoadICSlot)\n- src/compiler/js-native-context-specialization.cc: JSNativeContextSpecialization::BuildIndexedStringLoad\n- src/maglev/maglev-graph-builder.cc / src/maglev/maglev-ir.h: CheckStringOrStringWrapper node, DependOnStringWrapperToPrimitiveProtector\n\nWhy this is important: these symbols and files are the authoritative places that select the keyed-load string fast-path (handler Kind kIndexedString), emit / generate the CSA builtin handler that reads characters directly from string backing stores, attach or check the StringWrapperToPrimitive protector, and where the protector can be invalidated. These are the entry points that a fuzzer should target to stress the fast-path and protector guards across interpreter -> baseline -> optimizing tiers.\n",
  "context": [
    "string_wrapper_protector",
    "builtins_keyedload",
    "maglev_turbofan_guards"
  ],
  "explanation": "Initial RAG entry listing files and symbol names for KeyedLoadIC string indexed fast-path, CSA handlers, protector definition and invalidation points, interpreter feedback emission, and compiler lowering points relevant to string index loads. Collected from ic/*, codegen/*, execution/*, builtins/*, interpreter/*, compiler/* and maglev/* files.",
  "file_line": "src/ic/ic.cc:1300-1420; src/ic/handler-configuration-inl.h:1-220; src/ic/handler-configuration.h:1-260; src/ic/accessor-assembler.cc:GenerateKeyedLoadIC; src/builtins/builtins-ic-gen.cc:Generate_KeyedLoadIC; src/codegen/code-stub-assembler.cc/h:InvalidateStringWrapperToPrimitiveProtector, IsStringWrapper; src/execution/protectors.h:decls; src/execution/isolate.cc:UpdateStringWrapperToPrimitiveProtectorOnSetPrototype; src/roots/roots.h; src/codegen/heap-object-list.h; src/interpreter/interpreter-generator.cc; src/interpreter/bytecode-generator.cc; src/compiler/js-native-context-specialization.cc:BuildIndexedStringLoad; src/maglev/maglev-graph-builder.cc"
}