{
  "body": "Primary TS-based wrapper codegen entry file: wrappers.cc. Key builder class and dispatcher:\n- File: src/wasm/wrappers.cc\n- Symbols:\n  - class WasmWrapperTSGraphBuilder : public WasmGraphBuilderBase\n    \u2022 Methods:\n      \u2022 void BuildJSToWasmWrapper(bool do_conversion=true, OptionalOpIndex frame_state=..., bool set_in_wasm_flag=true)\n      \u2022 void BuildWasmToJSWrapper(ImportCallKind kind, int expected_arity, Suspend suspend)\n      \u2022 void BuildCapiCallWrapper()\n      \u2022 OpIndex FromJS(...), OpIndex ToJS(...): perform per-type conversions\n      \u2022 BuildCallWasmFromWrapper(...): constructs TSCallDescriptor with compiler::GetWasmCallDescriptor(..., WasmCallKind::kWasmIndirectFunction)\n      \u2022 BuildCallAndReturn(...): calls target wasm function and converts returns, including multi-return Array construction\n      \u2022 BuildSuspend(...): handles Promise-return integration by suspending and resuming via Builtin::kWasmSuspend and ActiveSuspender roots\n      \u2022 ModifyThreadInWasmFlagScope: RAII set/clear thread_in_wasm flag around host calls\n  - void BuildWasmWrapper(PipelineData*, AccountingAllocator*, Graph&, const CanonicalSig* sig, WrapperCompilationInfo info)\n    \u2022 Dispatch by CodeKind in info: JS_TO_WASM_FUNCTION -> BuildJSToWasmWrapper; WASM_TO_JS_FUNCTION -> BuildWasmToJSWrapper(kind, expected_arity, suspend); WASM_TO_CAPI_FUNCTION -> BuildCapiCallWrapper.\n- Builtin call descriptors: GetBuiltinCallDescriptor(Builtin, Zone*) helper produces TSCallDescriptor via compiler::Linkage::GetStubCallDescriptor and wraps into TSCallDescriptor::Create(...).\n- Call descriptors for wasm callee: BuildCallWasmFromWrapper constructs TSCallDescriptor from compiler::GetWasmCallDescriptor(..., WasmCallKind::kWasmIndirectFunction), CanThrow::kYes.\n- JS call entry from WasmToJS path: uses compiler::Linkage::GetJSCallDescriptor(...) when directly calling JSFunction, or Builtin::kCall_ReceiverIsAny trampoline with CallTrampolineDescriptor otherwise.\n- JS<->Wasm value conversions:\n  \u2022 ToJS: kI32/i64/f32/f64 -> Number/BigInt conversion via builtins; refs: func refs unwrap to external or go through kWasmInternalFunctionCreateExternal.\n  \u2022 FromJS: handles numeric and reference types; i64 via BigIntToI64/I32Pair builtin controlled by GetBigIntToI64CallDescriptor; reference types may call Runtime::kWasmJSToWasmObject.\n- Array/multi-return marshalling: BuildCallAllocateJSArray and StoreFixedArrayElement writes results for >1 returns.\n- Stack switching and suspender: BuildSwitchToTheCentralStack[IfNeeded]/Back and BuildSuspend implement JSPI/stack switching integration.\n- ThreadInWasm flag and central stack controls coordinate with IsolateData fields.\n",
  "context": [
    "wasm_wrappers_arch",
    "wrappers_core",
    "wasm_call_desc",
    "js_to_wasm_code_kind"
  ],
  "explanation": "This item captures the core TS-based code generation for wrapper stubs in wrappers.cc, including concrete entry symbol names, dispatch based on CodeKind, and the call descriptor construction points, which are central for JS\u2194Wasm wrapper generation.",
  "file_line": "wasm/wrappers.cc:1- end"
}